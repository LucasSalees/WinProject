<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema - WinProject</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/base.css?v=1.0}">
    <link rel="stylesheet" th:href="@{/css/components.css?v=1.0}">
    <link rel="stylesheet" th:href="@{/css/profile/profile.css?v=1.0}">
</head>

<body>
    
    <div th:replace="~{fragments/sidebar :: sidebar}"></div>
    
    <div th:replace="~{fragments/navbar :: navbar(pageTitle='Perfil do usuário')}"></div>
    
    <main id="main-content" class="main-content">
        <div class="container">
            <div class="card">
            <form action="/input/administrative/users/profile" th:object="${user}" method="POST" id="movimentacaoForm">
            <div class="row g-4">
                <!-- Seção: Dados Pessoais -->
                <div class="col-lg-6">
                    <div class="section-card personal-info-section">
                        <h3 class="section-title">
                            <i class="fas fa-user-circle"></i>
                            Dados Pessoais
                        </h3>
                        
                        <div class="row g-3 profile-field justify-content-center">
					        <div class="col-md-4 text-center">
					
					            <!-- Imagem de perfil -->
					            <img id="photoPreview"
								     class="img-preview rounded-circle shadow d-block mx-auto mb-2"
								     th:src="${user.photoPath == null or user.photoPath == '' or user.photoPath == 'DefaultAvatar.png'} ?
								             @{/images/DefaultAvatar.png} :
								             @{/user-photos/{file}(file=${user.photoPath})}"
								     alt="Preview" />
					
					            <!-- Input invisível -->
					            <input type="file"
					                   id="profileImage"
					                   name="profileImage"
					                   accept="image/*"
					                   class="d-none"
					                   onchange="previewPhoto(this)" />

					        </div>
					    </div>
                        
                        <div class="profile-field">
                            <div class="profile-label">
                                <i class="fas fa-signature"></i>
                                Nome Completo
                            </div>
                            <div class="profile-value" th:text="*{userName} ?: 'Não informado'">Nome do Usuário</div>
                        </div>
						                        
						<div class="profile-field">
						    <div class="profile-label">
						        <i class="fas fa-phone"></i>
						        Telefone
						    </div>
						    <div class="profile-value" th:text="*{userTel} ?: 'Não informado'">Telefone</div>
						</div>
                    </div>
                </div>

                <!-- Seção: Configurações de Acesso -->
                <div class="col-lg-6">
                    <div class="section-card access-config-section">
                        <h3 class="section-title">
                            <i class="fas fa-key"></i>
                            Configurações de Acesso
                        </h3>
                        
                        <div class="profile-field">
                            <div class="profile-label">
                                <i class="fas fa-briefcase"></i>
                                Profissão
                            </div>
                            <div class="profile-value" th:text="${user.userOccupation != null ? user.userOccupation.occupationName : '—'}">Profissão do Usuário</div>
                        </div>
                        
                        <div class="profile-field">
                            <div class="profile-label">
                                <i class="fas fa-briefcase"></i>
                                Função
                            </div>
                            <div class="profile-value" th:text="${user.userFunction != null ? user.userFunction.functionName : '—'}">Função do Usuário</div>
                        </div>
                        
                        <div class="profile-field">
                            <div class="profile-label">
                                <i class="fas fa-envelope"></i>
                                E-mail
                            </div>
                            <div class="profile-value email-value" th:text="*{userEmail} ?: 'Não informado'">email@input.com</div>
                        </div>
                        
                        <div class="profile-field">
                            <div class="profile-label">
                                <i class="fas fa-user-tag"></i>
                                Tipo de Usuário
                            </div>
                            <div class="profile-value">
                                <span class="type-badge" 
                                      th:classappend="${tipo == 'ADMIN' ? 'type-admin' : 'type-user'}"
                                      th:text="*{userRole}">ADMIN</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Seção: Horários Permitidos -->
                <div class="col-12">
                    <div class="section-card permissions-section">
                        <h3 class="section-title">
                            <i class="fas fa-clock"></i>
                            Horários de Acesso
                        </h3>
                        
                        <div class="info-card">
                            <p class="info-text">
                                <i class="fas fa-info-circle me-2"></i>
                                Horários em que o usuário tem permissão para acessar o sistema
                            </p>
                        </div>
                        
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="profile-field">
                                    <div class="profile-label">
                                        <i class="fas fa-clock"></i>
                                        Horário de Início
                                    </div>
                                    <div class="time-display" th:classappend="${startTime == null or startTime == '' ? 'time-empty' : ''}">
                                        <span th:if="${startTime != null and startTime != ''}" th:text="${startTime}">08:00</span>
										<span th:if="${startTime == null or startTime == ''}">Sem restrição</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="profile-field">
                                    <div class="profile-label">
                                        <i class="fas fa-clock"></i>
                                        Horário de Fim
                                    </div>
                                    <div class="time-display" th:classappend="${endTime == null or endTime == '' ? 'time-empty' : ''}">
                                        <span th:if="${endTime != null and endTime != ''}" th:text="${endTime}">18:00</span>
										<span th:if="${endTime == null or endTime == ''}">Sem restrição</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>

                <div class="col-12">
                    <div class="section-card permissions-section">
                        <h3 class="section-title">
                            <i class="fas fa-calendar-week"></i>
                            Dias da Semana Permitidos
                        </h3>
                        
                        <div class="info-card">
                            <p class="info-text">
                                <i class="fas fa-info-circle me-2"></i>
                                Dias da semana em que o usuário pode acessar o sistema
                            </p>
                        </div>
                        
                        <div class="dias-container">
                            <div class="dia-item" th:classappend="${#lists.contains(allowedDays, 'Segunda') ? 'ativo' : 'inativo'}">
                                <input class="form-check-input" type="checkbox" th:field="*{allowedDays}" 
                                       value="Segunda" th:checked="${#lists.contains(allowedDays, 'Segunda')}" disabled>
                                
                                <div class="dia-label">Segunda</div>
                            </div>
                            
                            <div class="dia-item" th:classappend="${#lists.contains(allowedDays, 'Terça') ? 'ativo' : 'inativo'}">
                                <input class="form-check-input" type="checkbox" th:field="*{allowedDays}" 
                                       value="Terça" th:checked="${#lists.contains(allowedDays, 'Terça')}" disabled>
                                
                                <div class="dia-label">Terça</div>
                            </div>
                            
                            <div class="dia-item" th:classappend="${#lists.contains(allowedDays, 'Quarta') ? 'ativo' : 'inativo'}">
                                <input class="form-check-input" type="checkbox" th:field="*{allowedDays}" 
                                       value="Quarta" th:checked="${#lists.contains(allowedDays, 'Quarta')}" disabled>
                                
                                <div class="dia-label">Quarta</div>
                            </div>
                            
                            <div class="dia-item" th:classappend="${#lists.contains(allowedDays, 'Quinta') ? 'ativo' : 'inativo'}">
                                <input class="form-check-input" type="checkbox" th:field="*{allowedDays}" 
                                       value="Quinta" th:checked="${#lists.contains(allowedDays, 'Quinta')}" disabled>
                                
                                <div class="dia-label">Quinta</div>
                            </div>
                            
                            <div class="dia-item" th:classappend="${#lists.contains(allowedDays, 'Sexta') ? 'ativo' : 'inativo'}">
                                <input class="form-check-input" type="checkbox" th:field="*{allowedDays}" 
                                       value="Sexta" th:checked="${#lists.contains(allowedDays, 'Sexta')}" disabled>
                                
                                <div class="dia-label">Sexta</div>
                            </div>
                            
                            <div class="dia-item" th:classappend="${#lists.contains(allowedDays, 'Sábado') ? 'ativo' : 'inativo'}">
                                <input class="form-check-input" type="checkbox" th:field="*{allowedDays}" 
                                       value="Sábado" th:checked="${#lists.contains(allowedDays, 'Sábado')}" disabled>
                                
                                <div class="dia-label">Sábado</div>
                            </div>
                            
                            <div class="dia-item" th:classappend="${#lists.contains(allowedDays, 'Domingo') ? 'ativo' : 'inativo'}">
                                <input class="form-check-input" type="checkbox" th:field="*{allowedDays}" 
                                       value="Domingo" th:checked="${#lists.contains(allowedDays, 'Domingo')}" disabled>
                                
                                <div class="dia-label">Domingo</div>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="hidden" th:field="*{userId}" />                    
                </form>
            </div>
        </div>
    </main>
    
    <div th:replace="~{fragments/sidebar :: modals}"></div>
    
    <div th:replace="~{fragments/footer :: footer}"></div>
    
    <script th:src="@{/js/components.js}"></script>
</body>
</html>