<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema - WinProject</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/base.css?v=1.0}">
    <link rel="stylesheet" th:href="@{/css/components.css?v=1.0}">
    <link rel="stylesheet" th:href="@{/css/registrations/registerProjects.css?v=1.0}">
    <link rel="stylesheet" th:href="@{/css/lists/departmentsList.css?v=1.0}">
</head>

<body>

    <div th:replace="~{fragments/sidebar :: sidebar}"></div>

    <div th:replace="~{fragments/navbar :: navbar(pageTitle='Cadastro de projeto')}"></div>

    <main id="main-content" class="main-content">
        <div class="container">
            <div class="card">
                <form action="/input/admin/projects/save" th:object="${project}" method="POST"
                    id="formulario">
                    <input type="hidden" th:field="*{projectId}" />
                    
                    <!-- SeÃ§Ã£o: InformaÃ§Ãµes BÃ¡sicas do Projeto -->
                    <div class="section-card access-config-section">
                        <h3 class="section-title">ðŸ“‹ InformaÃ§Ãµes BÃ¡sicas</h3>
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label shadow-text">Nome</label>
                                <input type="text" placeholder="Nome do projeto" class="form-control shadow-cantos"
                                    required maxlength="40" th:field="*{projectName}" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label shadow-text">Sigla contratual</label>
                                <input type="text" placeholder="SMS, SES, etc..." class="form-control shadow-cantos"
                                    required maxlength="4" th:field="*{projectContractualAcronym}">
                            </div>

                            <div class="col-md-3">
                                <label class="form-label shadow-text"> Data de cadastro</label>
                                <input type="date" class="form-control shadow-cantos" readonly
                                    th:field="*{projectRegisterDate}" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label shadow-text"> Data de atual</label>
                                <input type="date" class="form-control shadow-cantos" readonly
                                    th:field="*{ProjectCurrentDate}" />
                            </div>

                            <div class="col-12">
                                <label class="form-label shadow-text">Site</label>
                                <input type="url" placeholder="https://exemplo.com" class="form-control shadow-cantos"
                                    maxlength="100" th:field="*{projectWebsite}" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label shadow-text">Vertical de negÃ³cio</label>
                                <select class="form-control shadow-cantos" required
                                    th:field="*{projectBusinessVertical}">
                                    <option value="" disabled selected>Selecione a vertical de negÃ³cio</option>
                                    <option value="Diversos">Diversos</option>
                                    <option value="EducaÃ§Ã£o">EducaÃ§Ã£o</option>
                                    <option value="Esporte">Esporte</option>
                                    <option value="Igreja">Igreja</option>
                                    <option value="LogÃ­stica">LogÃ­stica</option>
                                    <option value="SaÃºde">SaÃºde</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label shadow-text">Prioridade</label>
                                <select class="form-control shadow-cantos" required th:field="*{projectPriority}">
                                    <option value="" disabled selected>Selecione a prioridade</option>
                                    <option value="Baixo">Baixo</option>
                                    <option value="MÃ©dio">MÃ©dio</option>
                                    <option value="Alto">Alto</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- SeÃ§Ã£o: ResponsÃ¡veis -->
                    <div class="section-card personal-info-section">
                        <h3 class="section-title">ðŸ‘¥ Dados do cliente</h3>

                        <!-- Gestor do Cliente -->
                        <div>
                            <h5 class="text-muted mb-3">Gestor do Cliente</h5>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label class="form-label shadow-text">Nome</label>
                                    <input type="text" placeholder="Nome do gestor" class="form-control shadow-cantos"
                                        th:field="*{projectClientManager}" maxlength="40" />
                                </div>
                                <div class="col-md-5">
                                    <label class="form-label shadow-text">Email</label>
                                    <div class="d-flex gap-2">
                                        <input type="text" placeholder="email@exemplo.com"
                                            class="form-control shadow-cantos" id="email-gestor"
                                            th:field="*{projectClientManagerEmail}" maxlength="25" />
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <label class="form-label shadow-text">Telefone</label>
                                    <input type="tel" placeholder="(00) 99999-9999" class="form-control shadow-cantos"
                                        th:field="*{projectClientManagerPhone}" id="telefone-gestor" />
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label shadow-text">CEP</label> <input type="text"
                                        placeholder="00000-000" class="form-control shadow-cantos" maxlength="9"
                                        th:field="*{projectClientZipCode}" id="cep-projeto" />
                                </div>
                                <div class="col-md-5">
                                    <label class="form-label shadow-text">EndereÃ§o</label> <input type="text"
                                        placeholder="Rua, Avenida, nÃºmero" class="form-control shadow-cantos"
                                        maxlength="100" th:field="*{projectClientAddress}" id="endereco-projeto" />
                                </div>
                                <div class="col-md-1">
                                    <label class="form-label shadow-text">NÂº</label>
                                    <input type="text" placeholder="123" class="form-control shadow-cantos"
                                        maxlength="100000" th:field="*{projectClientAddressNumber}" />
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label shadow-text">Complemento</label>
                                    <input type="text" placeholder="Casa, Apto, fundos..."
                                        class="form-control shadow-cantos" maxlength="100"
                                        th:field="*{projectClientAddressComplement}" />
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label shadow-text">Bairro</label> <input type="text"
                                        placeholder="Nome do bairro" class="form-control shadow-cantos" maxlength="50"
                                        th:field="*{projectClientDistrict}" id="bairro-projeto" />
                                </div>
                                <div class="col-md-5">
                                    <label class="form-label shadow-text">Cidade</label> <input type="text"
                                        placeholder="Nome da cidade" class="form-control shadow-cantos" maxlength="50"
                                        th:field="*{projectClientCity}" id="cidade-projeto" />
                                </div>

                                <div class="col-md-4">
                                    <label class="form-label shadow-text">Estado</label>
                                    <select th:field="*{projectClientState}" class="form-control shadow-cantos"
                                        id="estado-projeto" required>
                                        <option value="" disabled selected>Selecione uma estado</option>
                                        <option th:each="reg : ${T(com.project.system.enums.input.BrazilianStateUF).values()}"
                                            th:value="${reg}" th:text="${reg.name()}">
                                        </option>

                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SeÃ§Ã£o: Cronograma do Projeto -->
                    <div class="section-card access-config-section">
                        <h3 class="section-title">ðŸ“… Cronograma</h3>

                        <!-- Planejamento -->
                        <div class="mb-4">
                            <h5 class="text-muted mb-3">Planejamento</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label shadow-text">Data Inicial do Planejamento</label>
                                    <input type="date" class="form-control shadow-cantos" required
                                        th:field="*{projectPlanningStartDate}" />
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label shadow-text">Data Final do Planejamento</label>
                                    <input type="date" class="form-control shadow-cantos" required
                                        th:field="*{projectPlanningEndDate}" />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label shadow-text">DuraÃ§Ã£o</label>
                                    <input type="text" class="form-control shadow-cantos" th:field="*{projectDuration}"
                                        placeholder="0 dias" readonly />
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label shadow-text">OrÃ§amento</label>
                                    <input type="text" class="form-control shadow-cantos" required id="budgetInput"
                                        name="projectBudget" placeholder="R$ 0,00" th:field="*{projectBudget}" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SeÃ§Ã£o: ResponsÃ¡veis -->
                    <div class="section-card personal-info-section">
                        <h3 class="section-title">ðŸ‘¥ Dados do gerente</h3>

                        <!-- Gerente Local -->
                        <div class="mb-4">
                            <h5 class="text-muted mb-3">Gerente Local</h5>

                            <div class="row g-3">

                                <div class="col-md-4">
                                    <label class="form-label text-muted small">Cod - Nome - Gerente</label>
                                    <div class="time-range-container">
                                        <div class="form-control shadow-cantos" id="campoDepartamento"
                                            style="cursor: pointer;">
                                            <span id="textoDepartamentoSelecionada">Selecione um departamento</span>
                                        </div>
                                        <input type="hidden" name="userDepartment" id="userDepartment">
                                    </div>
                                </div>

                                <div class="col-md-5">
                                    <label class="form-label shadow-text">Email</label>
                                    <div class="d-flex gap-2">
                                        <input type="text" id="email-gerente" placeholder="email@exemplo.com"
                                            class="form-control shadow-cantos flex-grow-1"
                                            th:field="*{projectLocalManagerEmail}" maxlength="25" readonly />
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <label class="form-label shadow-text">Telefone</label>
                                    <input type="tel" placeholder="(00) 99999-9999" class="form-control shadow-cantos"
                                        th:field="*{projectLocalManagerPhone}" id="telefone-gerente" readonly />
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="section-card access-config-section">
                        <h3 class="section-title">ðŸ“Š Status e Progresso</h3>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label shadow-text">Status do Projeto</label>
                                <select id="statusProjeto" class="form-control shadow-cantos" required
                                    th:field="*{projectStatus}">
                                    <option value="" disabled selected>Selecione o status</option>
                                    <option value="NÃ£o iniciado">ðŸ”´ NÃ£o iniciado</option>
                                    <option value="Em planejamento">ðŸŸ¡ Em planejamento</option>
                                    <option value="Em execuÃ§Ã£o">ðŸ”µ Em execuÃ§Ã£o</option>
                                    <option value="Atrasado">ðŸŸ  Atrasado</option>
                                    <option value="ConcluÃ­do">ðŸŸ¢ ConcluÃ­do</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label shadow-text">Percentual de ExecuÃ§Ã£o %</label>
                                <div class="input-group">
                                    <input type="number" min="0" max="100" step="1" class="form-control shadow-cantos"
                                        placeholder="0" th:field="*{projectExecutionPercentage}"
                                        id="percentualExecucao" />
                                    <span class="input-group-text">%</span>
                                </div>

                                <!-- Barra de progresso abaixo do input -->
                                <div class="progress mt-2">
                                    <div id="barraProgresso"
                                        class="progress-bar progress-bar-striped progress-bar-animated"
                                        role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
                                        style="width: 0%">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SeÃ§Ã£o: ObservaÃ§Ãµes -->
                    <div class="section-card personal-info-section">
                        <h3 class="section-title">ðŸ’¬ ObservaÃ§Ãµes e ComentÃ¡rios</h3>
                        <div class="mb-3">
                            <label for="comentarios" class="form-label shadow-text">ComentÃ¡rios
                                Adicionais</label>
                            <textarea class="form-control shadow-cantos" th:field="*{projectComment}" id="comentarios"
                                rows="4" maxlength="700"
                                placeholder="Adicione observaÃ§Ãµes, notas importantes ou comentÃ¡rios sobre o projeto...">
					        </textarea>
                            <!--  Contador de caracteres -->
                            <div class="text-end">
                                <small id="contador-comentarios" style="font-size: 0.6rem;">0/700</small>
                            </div>
                        </div>
                    </div>

                    <div class="navegacaoLista custom-button-container">
                        <a>
                        </a>
                        <div>
	                        <button 
	                            type="submit" 
	                            class="btn btn-primary"
	                            onclick="salvar(event, this.form)">
	                            <i class="fa-solid fa-floppy-disk"></i> 
	                            Salvar
	                        </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Modal para seleÃ§Ã£o do departamento -->
    <div id="modalListaDepartamentos" class="modal">
        <div class="modal-container" style="max-width: 90vw; width: 1000px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Selecionar departamento</h2>
                    <button type="button" class="modal-close" id="fecharModalListaDepartamento">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">

                    <!-- Filtro e seleÃ§Ã£o de campos -->
                    <div class="form-inline mb-3">
                        <div class="navegacaoLista custom-button-container">
                        <!-- BotÃ£o Ã  esquerda -->
                        <div class="botoes-esquerda">
                            
                        </div>
                            <div class="botoes-direita">
                                <input type="text" id="filtro" class="form-control shadow-cantos" placeholder="Pesquisar...">
	                        	<div class="dropdown botoes">
		                           <button class="btn btn-primary" type="button" id="dropdownMenuButtonDepartamentos">
								      Selecionar
								  </button>
                                    <div class="dropdown-menu" id="dropdownCamposDepartamentos">
                                        <h1 class="dropdown-item-titulo text-center">Campos VisÃ­veis</h1>
                                        <label class="dropdown-item-1"><input type="checkbox"
                                                id="selecionarTodosDepartamentos"> <span>Selecionar Todos</span></label>
                                        <label class="dropdown-item-1"><input type="checkbox" class="campoCheckbox"
                                                id="campoCodigoDepartamento" checked> <span>CÃ³digo</span></label>
                                        <label class="dropdown-item-1"><input type="checkbox" class="campoCheckbox"
                                                id="campoNomeDepartamento" checked> <span>Nome</span></label>
                                        <label class="dropdown-item-1"><input type="checkbox" class="campoCheckbox"
                                                id="campoGerenteDepartamento" checked> <span>Gerente</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> 

                    <!-- Tabela de departamentos -->
                    <div class="table-container-modal">
                        <table class="table table-striped" id="tabelaDepartamentos">
                            <thead>
                                <tr>
                                    <th class="text-left">Cod</th>
                                    <th class="text-left">Nome</th>
                                    <th class="text-left">Gerente</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="department : ${departments}" class="linha-departamento"
                                    style="cursor: pointer;" th:data-id="${department.departmentId}"
                                    th:data-nome="${department.departmentName}"
                                    th:data-gerente="${department.departmentManager}"
                                    th:data-email="${department.departmentEmail}"
                                    th:data-telefone="${department.departmentTel}">
                                    <td th:text="${department.departmentId}"></td>
                                    <td th:text="${department.departmentName}"></td>
                                    <td th:text="${department.departmentManager}"></td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="~{fragments/sidebar :: modals}"></div>

    <div th:replace="~{fragments/footer :: footer}"></div>

    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.js"></script>

    <script th:src="@{/js/admin/components.js}"></script>

    <script th:src="@{/js/admin/registrations/registerProjects.js}"></script>

</body>

</html>